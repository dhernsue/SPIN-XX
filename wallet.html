<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wallet</title>
</head>
<body style="font-family: Arial; text-align:center; padding:50px;">

  <h2>Wallet</h2>

  <input type="number" id="amount" placeholder="Enter Amount">
  <br><br>
  <button onclick="deposit()">Deposit</button>
  <button onclick="withdraw()">Withdraw</button>

  <script src="https://sdk.cashfree.com/js/ui/2.0.0/cashfree.prod.js"></script>
  <script>
    async function deposit() {
      const amount = document.getElementById("amount").value;
      if (!amount || amount <= 0) {
        alert("Enter valid amount");
        return;
      }

      const res = await fetch("http://localhost:3000/create-order", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ amount: amount })
      });

      const data = await res.json();

      if (!data.payment_session_id) {
        alert("Error: " + (data.error || "Unable to start payment"));
        return;
      }

      const cashfree = new Cashfree({ mode: "PROD" });
      cashfree.pay({
        paymentSessionId: data.payment_session_id,
        redirectTarget: "_self"
      });
    }

    async function withdraw() {
      const amount = document.getElementById("amount").value;
      if (!amount || amount <= 0) {
        alert("Enter valid amount");
        return;
      }

      const res = await fetch("http://localhost:3000/withdraw", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ amount: amount })
      });

      const data = await res.json();
      alert("Withdraw response: " + JSON.stringify(data));
    }
  </script>

</body>
</html>
